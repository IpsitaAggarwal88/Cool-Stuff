<!DOCTYPE html>
<html>
<head>
	<title>Marioman</title>
	<link rel="stylesheet" type="text/css" href="style.css">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			var map=[[0,0,0,0,0,0,0,0,0,0],
					 [0,2,1,1,1,1,1,4,1,0],
					 [0,1,1,0,0,0,1,1,0,0],
					 [0,1,1,1,1,0,0,1,0,0],
					 [0,0,0,1,1,0,0,1,0,0],
					 [0,0,0,1,4,0,0,1,0,0],
					 [0,0,0,1,1,0,0,1,0,0],
					 [0,0,0,1,1,0,0,1,0,0],
					 [0,0,0,1,1,0,0,1,0,0],
					 [0,0,0,0,0,0,0,0,0,0]
			];
			var mario={
				'x':1,
				'y':1
			};
			
			function updateMap(){
				var htmlStr='';
				for(var x=0;x<map.length;x++)
				{
					for(var y=0;y<map[x].length;y++)
					{
						if(map[x][y]===0)
						{
							htmlStr+='<div class="wall"></div>';
						}
						if(map[x][y]===1)
						{
							htmlStr+='<div class="ground"><img src="star.png"></div>';
						}
						if(map[x][y]===2)
						{
							htmlStr+='<div class="ground"><img src="mario.png"></div>';
						}
						if(map[x][y]===3)
						{
							htmlStr+='<div class="ground"></div>';
						}
						if(map[x][y]===4)
						{
							htmlStr+='<div class="ground"><img src="mushroom.png"></div>';
						}
					}
				}
				$("#world").html(htmlStr);
			}
			updateMap();
			var text='';
			var score=0;
			
			$(document).on("keydown", function(event){
				
				
				if(event.keyCode===37)//left
				{
					if(map[mario.x][mario.y-1]>0){
						if(map[mario.x][mario.y-1]===1)
						{
							score++;

							console.log("score after left key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						if(map[mario.x][mario.y-1]===4)
						{
							score+=5;
							console.log("score after left key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						map[mario.x][mario.y]=3;
						mario.y--;
						map[mario.x][mario.y]=2;
						updateMap();
					}
					
				}
				if(event.keyCode===38)//top
				{
					if(map[mario.x-1][mario.y]>0){
						if(map[mario.x-1][mario.y]===1)
						{
							score++;
							console.log("score after top key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						if(map[mario.x-1][mario.y]===4)
						{
							score+=5;
							console.log("score after left key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						
						map[mario.x][mario.y]=3;
						mario.x--;
						map[mario.x][mario.y]=2;
						updateMap();
					}
					
				}
				if(event.keyCode===39)//right
				{
					if(map[mario.x][mario.y+1]>0)
					{
						if(map[mario.x][mario.y+1]===1)
						{
							score++;
							console.log("score after right key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						if(map[mario.x][mario.y+1]===4)
						{
							score+=5;
							console.log("score after left key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						
						map[mario.x][mario.y]=3;
						mario.y++;
						map[mario.x][mario.y]=2;
						updateMap();
					}

						
					
					
				}
				if(event.keyCode===40)//bottom
				{
					if(map[mario.x+1][mario.y]>0){
						if(map[mario.x+1][mario.y]===1){
							score++;
							console.log("score after bottom key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						if(map[mario.x+1][mario.y]===4)
						{
							score+=5;
							console.log("score after left key"+score);
							$('#score').html('<p>Your current score is: '+score+'</p>');
						}
						
						map[mario.x][mario.y]=3;
						mario.x++;
						map[mario.x][mario.y]=2;
						updateMap();
					}
					
				}
				
			})
			//console.log("score is"+score);
			/*text+=score;
				//console.log(text);
				text+='</p></div>';
			//console.log("new text"+text);
			$('body').append(text);*/
			
			return false;
		})
	</script>
</head>
<body>
	<div id="world">
		
	</div>
	<div id="score"></div>
</body>
</html>